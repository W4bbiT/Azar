{"ast":null,"code":"/*\nCopyright (c) NAVER Corp.\nname: @egjs/imready\nlicense: MIT\nauthor: NAVER Corp.\nrepository: https://github.com/naver/egjs-imready\nversion: 1.4.1\n*/\nimport Component, { ComponentEvent } from '@egjs/component';\nimport { reactive, isString } from '@cfcs/core';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\n\n/** @deprecated */\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n  return r;\n}\n\n/*\negjs-imready\nCopyright (c) 2020-present NAVER Corp.\nMIT license\n*/\nvar isWindow = typeof window !== \"undefined\";\nvar ua = isWindow ? window.navigator.userAgent : \"\";\nvar SUPPORT_COMPUTEDSTYLE = isWindow ? !!(\"getComputedStyle\" in window) : false;\nvar IS_IE = /MSIE|Trident|Windows Phone|Edge/.test(ua);\nvar SUPPORT_ADDEVENTLISTENER = isWindow ? !!(\"addEventListener\" in document) : false;\nvar WIDTH = \"width\";\nvar HEIGHT = \"height\";\nvar PROPS = [\"prefix\", \"loaders\"];\nvar EVENTS = [\"preReadyElement\", \"readyElement\", \"error\", \"preReady\", \"ready\"];\nfunction getAttribute(el, name) {\n  return el.getAttribute(name) || \"\";\n}\nfunction toArray(arr) {\n  return [].slice.call(arr);\n}\nfunction hasSizeAttribute(target, prefix) {\n  if (prefix === void 0) {\n    prefix = \"data-\";\n  }\n  return !!target.getAttribute(prefix + \"width\");\n}\nfunction hasLoadingAttribute(target, prefix) {\n  if (prefix === void 0) {\n    prefix = \"data-\";\n  }\n  return \"loading\" in target && target.getAttribute(\"loading\") === \"lazy\" || !!target.getAttribute(prefix + \"lazy\");\n}\nfunction hasSkipAttribute(target, prefix) {\n  if (prefix === void 0) {\n    prefix = \"data-\";\n  }\n  return !!target.getAttribute(prefix + \"skip\");\n}\nfunction addEvent(element, type, handler) {\n  if (SUPPORT_ADDEVENTLISTENER) {\n    element.addEventListener(type, handler, false);\n  } else if (element.attachEvent) {\n    element.attachEvent(\"on\" + type, handler);\n  } else {\n    element[\"on\" + type] = handler;\n  }\n}\nfunction removeEvent(element, type, handler) {\n  if (element.removeEventListener) {\n    element.removeEventListener(type, handler, false);\n  } else if (element.detachEvent) {\n    element.detachEvent(\"on\" + type, handler);\n  } else {\n    element[\"on\" + type] = null;\n  }\n}\nfunction innerWidth(el) {\n  return getSize(el, \"Width\");\n}\nfunction innerHeight(el) {\n  return getSize(el, \"Height\");\n}\nfunction getStyles(el) {\n  return (SUPPORT_COMPUTEDSTYLE ? window.getComputedStyle(el) : el.currentStyle) || {};\n}\nfunction getSize(el, name) {\n  var size = el[\"client\" + name] || el[\"offset\" + name];\n  return parseFloat(size || getStyles(el)[name.toLowerCase()]) || 0;\n}\nfunction getContentElements(element, tags, prefix) {\n  var skipElements = toArray(element.querySelectorAll(__spreadArrays([\"[\" + prefix + \"skip] [\" + prefix + \"width]\"], tags.map(function (tag) {\n    return [\"[\" + prefix + \"skip] \" + tag, tag + \"[\" + prefix + \"skip]\", \"[\" + prefix + \"width] \" + tag].join(\", \");\n  })).join(\", \")));\n  return toArray(element.querySelectorAll(\"[\" + prefix + \"width], \" + tags.join(\", \"))).filter(function (el) {\n    return skipElements.indexOf(el) === -1;\n  });\n}\n\n/*\negjs-imready\nCopyright (c) 2020-present NAVER Corp.\nMIT license\n*/\nvar elements = [];\nfunction addAutoSizer(element, prefix) {\n  !elements.length && addEvent(window, \"resize\", resizeAllAutoSizers);\n  element.__PREFIX__ = prefix;\n  elements.push(element);\n  resize(element);\n}\nfunction removeAutoSizer(element, prefix) {\n  var index = elements.indexOf(element);\n  if (index < 0) {\n    return;\n  }\n  var fixed = getAttribute(element, prefix + \"fixed\");\n  delete element.__PREFIX__;\n  element.style[fixed === HEIGHT ? WIDTH : HEIGHT] = \"\";\n  elements.splice(index, 1);\n  !elements.length && removeEvent(window, \"resize\", resizeAllAutoSizers);\n}\nfunction resize(element, prefix) {\n  if (prefix === void 0) {\n    prefix = \"data-\";\n  }\n  var elementPrefix = element.__PREFIX__ || prefix;\n  var dataWidth = parseInt(getAttribute(element, \"\" + elementPrefix + WIDTH), 10) || 0;\n  var dataHeight = parseInt(getAttribute(element, \"\" + elementPrefix + HEIGHT), 10) || 0;\n  var fixed = getAttribute(element, elementPrefix + \"fixed\");\n  if (fixed === HEIGHT) {\n    var size = innerHeight(element) || dataHeight;\n    element.style[WIDTH] = dataWidth / dataHeight * size + \"px\";\n  } else {\n    var size = innerWidth(element) || dataWidth;\n    element.style[HEIGHT] = dataHeight / dataWidth * size + \"px\";\n  }\n}\nfunction resizeAllAutoSizers() {\n  elements.forEach(function (element) {\n    resize(element);\n  });\n}\nvar Loader = /*#__PURE__*/function (_super) {\n  __extends(Loader, _super);\n  function Loader(element, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    var _this = _super.call(this) || this;\n    _this.isReady = false;\n    _this.isPreReady = false;\n    _this.hasDataSize = false;\n    _this.hasLoading = false;\n    _this.isSkip = false;\n    _this.onCheck = function (e) {\n      _this.clear();\n      if (e && e.type === \"error\") {\n        _this.onError(_this.element);\n      }\n      if (_this.hasLoading && _this.checkElement()) {\n        // I'm not ready\n        return;\n      }\n      // I'm pre-ready and ready!\n      var withPreReady = !_this.hasDataSize && !_this.hasLoading;\n      _this.onReady(withPreReady);\n    };\n    _this.options = __assign({\n      prefix: \"data-\"\n    }, options);\n    _this.element = element;\n    var prefix = _this.options.prefix;\n    _this.hasDataSize = hasSizeAttribute(element, prefix);\n    _this.isSkip = hasSkipAttribute(element, prefix);\n    _this.hasLoading = hasLoadingAttribute(element, prefix);\n    return _this;\n  }\n  var __proto = Loader.prototype;\n  __proto.check = function () {\n    if (this.isSkip || !this.checkElement()) {\n      // I'm Ready\n      this.onAlreadyReady(true);\n      return false;\n    }\n    if (this.hasDataSize) {\n      addAutoSizer(this.element, this.options.prefix);\n    }\n    if (this.hasDataSize || this.hasLoading) {\n      // I'm Pre Ready\n      this.onAlreadyPreReady();\n    }\n    // Wati Pre Ready, Ready\n    return true;\n  };\n  __proto.addEvents = function () {\n    var _this = this;\n    var element = this.element;\n    this.constructor.EVENTS.forEach(function (name) {\n      addEvent(element, name, _this.onCheck);\n    });\n  };\n  __proto.clear = function () {\n    var _this = this;\n    var element = this.element;\n    this.constructor.EVENTS.forEach(function (name) {\n      removeEvent(element, name, _this.onCheck);\n    });\n    this.removeAutoSizer();\n  };\n  __proto.destroy = function () {\n    this.clear();\n    this.off();\n  };\n  __proto.removeAutoSizer = function () {\n    if (this.hasDataSize) {\n      // I'm already ready.\n      var prefix = this.options.prefix;\n      removeAutoSizer(this.element, prefix);\n    }\n  };\n  __proto.onError = function (target) {\n    this.trigger(\"error\", {\n      element: this.element,\n      target: target\n    });\n  };\n  __proto.onPreReady = function () {\n    if (this.isPreReady) {\n      return;\n    }\n    this.isPreReady = true;\n    this.trigger(\"preReady\", {\n      element: this.element,\n      hasLoading: this.hasLoading,\n      isSkip: this.isSkip\n    });\n  };\n  __proto.onReady = function (withPreReady) {\n    if (this.isReady) {\n      return;\n    }\n    withPreReady = !this.isPreReady && withPreReady;\n    if (withPreReady) {\n      this.isPreReady = true;\n    }\n    this.removeAutoSizer();\n    this.isReady = true;\n    this.trigger(\"ready\", {\n      element: this.element,\n      withPreReady: withPreReady,\n      hasLoading: this.hasLoading,\n      isSkip: this.isSkip\n    });\n  };\n  __proto.onAlreadyError = function (target) {\n    var _this = this;\n    setTimeout(function () {\n      _this.onError(target);\n    });\n  };\n  __proto.onAlreadyPreReady = function () {\n    var _this = this;\n    setTimeout(function () {\n      _this.onPreReady();\n    });\n  };\n  __proto.onAlreadyReady = function (withPreReady) {\n    var _this = this;\n    setTimeout(function () {\n      _this.onReady(withPreReady);\n    });\n  };\n  Loader.EVENTS = [];\n  return Loader;\n}(Component);\nvar ElementLoader = /*#__PURE__*/function (_super) {\n  __extends(ElementLoader, _super);\n  function ElementLoader() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = ElementLoader.prototype;\n  __proto.setHasLoading = function (hasLoading) {\n    this.hasLoading = hasLoading;\n  };\n  __proto.check = function () {\n    if (this.isSkip) {\n      // I'm Ready\n      this.onAlreadyReady(true);\n      return false;\n    }\n    if (this.hasDataSize) {\n      addAutoSizer(this.element, this.options.prefix);\n      this.onAlreadyPreReady();\n    } else {\n      // has not data size\n      this.trigger(\"requestChildren\");\n    }\n    return true;\n  };\n  __proto.checkElement = function () {\n    return true;\n  };\n  __proto.destroy = function () {\n    this.clear();\n    this.trigger(\"requestDestroy\");\n    this.off();\n  };\n  __proto.onAlreadyPreReady = function () {\n    // has data size\n    _super.prototype.onAlreadyPreReady.call(this);\n    this.trigger(\"reqeustReadyChildren\");\n  };\n  ElementLoader.EVENTS = [];\n  return ElementLoader;\n}(Loader);\n\n/**\n * @alias eg.ImReady\n * @extends eg.Component\n */\nvar ImReadyManager = /*#__PURE__*/function (_super) {\n  __extends(ImReadyManager, _super);\n  /**\n   * @param - ImReady's options\n   */\n  function ImReadyManager(options) {\n    if (options === void 0) {\n      options = {};\n    }\n    var _this = _super.call(this) || this;\n    _this.readyCount = 0;\n    _this.preReadyCount = 0;\n    _this.totalCount = 0;\n    _this.totalErrorCount = 0;\n    _this.isPreReadyOver = true;\n    _this.elementInfos = [];\n    _this.options = __assign({\n      loaders: {},\n      prefix: \"data-\"\n    }, options);\n    return _this;\n  }\n  /**\n   * Checks whether elements are in the ready state.\n   * @ko 엘리먼트가 준비 상태인지 체크한다.\n   * @elements - Elements to check ready status. <ko> 준비 상태를 체크할 엘리먼트들.</ko>\n   * @example\n     * ```html\n     * <div>\n     *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n     *    <img src=\"./2.jpg\" data-width=\"1280\" data-height=\"853\"/>\n     *    <img src=\"ERR\" data-width=\"1280\" data-height=\"853\"/>\n     * </div>\n     * ```\n     * ## Javascript\n     * ```js\n     * import ImReady from \"@egjs/imready\";\n     *\n     * const im = new ImReady(); // umd: eg.ImReady\n     * im.check(document.querySelectorAll(\"img\")).on({\n     *   preReadyElement: e => {\n     *     // 1, 3\n     *     // 2, 3\n     *     // 3, 3\n     *     console.log(e.preReadyCount, e.totalCount),\n     *   },\n     * });\n     * ```\n   */\n  var __proto = ImReadyManager.prototype;\n  __proto.check = function (elements) {\n    var _this = this;\n    var prefix = this.options.prefix;\n    this.clear();\n    this.elementInfos = toArray(elements).map(function (element, index) {\n      var loader = _this.getLoader(element, {\n        prefix: prefix\n      });\n      loader.check();\n      loader.on(\"error\", function (e) {\n        _this.onError(index, e.target);\n      }).on(\"preReady\", function (e) {\n        var info = _this.elementInfos[index];\n        info.hasLoading = e.hasLoading;\n        info.isSkip = e.isSkip;\n        var isPreReady = _this.checkPreReady(index);\n        _this.onPreReadyElement(index);\n        isPreReady && _this.onPreReady();\n      }).on(\"ready\", function (_a) {\n        var withPreReady = _a.withPreReady,\n          hasLoading = _a.hasLoading,\n          isSkip = _a.isSkip;\n        var info = _this.elementInfos[index];\n        info.hasLoading = hasLoading;\n        info.isSkip = isSkip;\n        var isPreReady = withPreReady && _this.checkPreReady(index);\n        var isReady = _this.checkReady(index);\n        // Pre-ready and ready occur simultaneously\n        withPreReady && _this.onPreReadyElement(index);\n        _this.onReadyElement(index);\n        isPreReady && _this.onPreReady();\n        isReady && _this.onReady();\n      });\n      return {\n        loader: loader,\n        element: element,\n        hasLoading: false,\n        hasError: false,\n        isPreReady: false,\n        isReady: false,\n        isSkip: false\n      };\n    });\n    var length = this.elementInfos.length;\n    this.totalCount = length;\n    if (!length) {\n      setTimeout(function () {\n        _this.onPreReady();\n        _this.onReady();\n      });\n    }\n    return this;\n  };\n  /**\n   * Gets the total count of elements to be checked.\n   * @ko 체크하는 element의 총 개수를 가져온다.\n   */\n  __proto.getTotalCount = function () {\n    return this.totalCount;\n  };\n  /**\n   * Whether the elements are all pre-ready. (all sizes are known)\n   * @ko 엘리먼트들이 모두 사전 준비가 됐는지 (사이즈를 전부 알 수 있는지) 여부.\n   */\n  __proto.isPreReady = function () {\n    return this.elementInfos.every(function (info) {\n      return info.isPreReady;\n    });\n  };\n  /**\n   * Whether the elements are all ready.\n   * @ko 엘리먼트들이 모두 준비가 됐는지 여부.\n   */\n  __proto.isReady = function () {\n    return this.elementInfos.every(function (info) {\n      return info.isReady;\n    });\n  };\n  /**\n   * Whether an error has occurred in the elements in the current state.\n   * @ko 현재 상태에서 엘리먼트들이 에러가 발생했는지 여부.\n   */\n  __proto.hasError = function () {\n    return this.totalErrorCount > 0;\n  };\n  /**\n   * Clears events of elements being checked.\n   * @ko 체크 중인 엘리먼트들의 이벤트를 해제 한다.\n   */\n  __proto.clear = function () {\n    this.isPreReadyOver = false;\n    this.totalCount = 0;\n    this.preReadyCount = 0;\n    this.readyCount = 0;\n    this.totalErrorCount = 0;\n    this.elementInfos.forEach(function (info) {\n      if (info.loader) {\n        info.loader.destroy();\n      }\n    });\n    this.elementInfos = [];\n  };\n  /**\n   * Destory all events.\n   * @ko 모든 이벤트를 해제 한다.\n   */\n  __proto.destroy = function () {\n    this.clear();\n    this.off();\n  };\n  __proto.getLoader = function (element, options) {\n    var _this = this;\n    var tagName = element.tagName.toLowerCase();\n    var loaders = this.options.loaders;\n    var prefix = options.prefix;\n    var tags = Object.keys(loaders);\n    if (loaders[tagName]) {\n      return new loaders[tagName](element, options);\n    }\n    var loader = new ElementLoader(element, options);\n    var children = toArray(element.querySelectorAll(tags.join(\", \")));\n    loader.setHasLoading(children.some(function (el) {\n      return hasLoadingAttribute(el, prefix);\n    }));\n    var withPreReady = false;\n    var childrenImReady = this.clone().on(\"error\", function (e) {\n      loader.onError(e.target);\n    }).on(\"ready\", function () {\n      loader.onReady(withPreReady);\n    });\n    loader.on(\"requestChildren\", function () {\n      // has not data size\n      var contentElements = getContentElements(element, tags, _this.options.prefix);\n      childrenImReady.check(contentElements).on(\"preReady\", function (e) {\n        withPreReady = e.isReady;\n        if (!withPreReady) {\n          loader.onPreReady();\n        }\n      });\n    }).on(\"reqeustReadyChildren\", function () {\n      // has data size\n      // loader call preReady\n      // check only video, image elements\n      childrenImReady.check(children);\n    }).on(\"requestDestroy\", function () {\n      childrenImReady.destroy();\n    });\n    return loader;\n  };\n  __proto.clone = function () {\n    return new ImReadyManager(__assign({}, this.options));\n  };\n  __proto.checkPreReady = function (index) {\n    this.elementInfos[index].isPreReady = true;\n    ++this.preReadyCount;\n    if (this.preReadyCount < this.totalCount) {\n      return false;\n    }\n    return true;\n  };\n  __proto.checkReady = function (index) {\n    this.elementInfos[index].isReady = true;\n    ++this.readyCount;\n    if (this.readyCount < this.totalCount) {\n      return false;\n    }\n    return true;\n  };\n  __proto.onError = function (index, target) {\n    var info = this.elementInfos[index];\n    info.hasError = true;\n    /**\n     * An event occurs if the image, video fails to load.\n     * @ko 이미지, 비디오가 로딩에 실패하면 이벤트가 발생한다.\n     * @event eg.ImReady#error\n     * @param {eg.ImReady.OnError} e - The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n     * @example\n     * ```html\n     * <div>\n     *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n     *    <img src=\"./2.jpg\"/>\n     *    <img src=\"ERR\"/>\n     * </div>\n     * ```\n     * ## Javascript\n     * ```js\n     * import ImReady from \"@egjs/imready\";\n     *\n     * const im = new ImReady(); // umd: eg.ImReady\n     * im.check([document.querySelector(\"div\")]).on({\n     *   error: e => {\n     *     // <div>...</div>, 0, <img src=\"ERR\"/>\n     *     console.log(e.element, e.index, e.target),\n     *   },\n     * });\n     * ```\n     */\n    this.trigger(new ComponentEvent(\"error\", {\n      element: info.element,\n      index: index,\n      target: target,\n      errorCount: this.getErrorCount(),\n      totalErrorCount: ++this.totalErrorCount\n    }));\n  };\n  __proto.onPreReadyElement = function (index) {\n    var info = this.elementInfos[index];\n    /**\n     * An event occurs when the element is pre-ready (when the loading attribute is applied or the size is known)\n     * @ko 해당 엘리먼트가 사전 준비되었을 때(loading 속성이 적용되었거나 사이즈를 알 수 있을 때) 이벤트가 발생한다.\n     * @event eg.ImReady#preReadyElement\n     * @param {eg.ImReady.OnPreReadyElement} e - The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n     * @example\n     * ```html\n     * <div>\n     *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n     *    <img src=\"./2.jpg\" data-width=\"1280\" data-height=\"853\"/>\n     *    <img src=\"ERR\" data-width=\"1280\" data-height=\"853\"/>\n     * </div>\n     * ```\n     * ## Javascript\n     * ```js\n     * import ImReady from \"@egjs/imready\";\n     *\n     * const im = new ImReady(); // umd: eg.ImReady\n     * im.check(document.querySelectorAll(\"img\")).on({\n     *   preReadyElement: e => {\n     *     // 1, 3\n     *     // 2, 3\n     *     // 3, 3\n     *     console.log(e.preReadyCount, e.totalCount),\n     *   },\n     * });\n     * ```\n     */\n    this.trigger(new ComponentEvent(\"preReadyElement\", {\n      element: info.element,\n      index: index,\n      preReadyCount: this.preReadyCount,\n      readyCount: this.readyCount,\n      totalCount: this.totalCount,\n      isPreReady: this.isPreReady(),\n      isReady: this.isReady(),\n      hasLoading: info.hasLoading,\n      isSkip: info.isSkip\n    }));\n  };\n  __proto.onPreReady = function () {\n    this.isPreReadyOver = true;\n    /**\n     * An event occurs when all element are pre-ready (When all elements have the loading attribute applied or the size is known)\n     * @ko 모든 엘리먼트들이 사전 준비된 경우 (모든 엘리먼트들이 loading 속성이 적용되었거나 사이즈를 알 수 있는 경우) 이벤트가 발생한다.\n     * @event eg.ImReady#preReady\n     * @param {eg.ImReady.OnPreReady} e - The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n     * @example\n     * ```html\n     * <div>\n     *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n     *    <img src=\"./2.jpg\" data-width=\"1280\" data-height=\"853\"/>\n     *    <img src=\"ERR\" data-width=\"1280\" data-height=\"853\"/>\n     * </div>\n     * ```\n     * ## Javascript\n     * ```js\n     * import ImReady from \"@egjs/imready\";\n     *\n     * const im = new ImReady(); // umd: eg.ImReady\n     * im.check(document.querySelectorAll(\"img\")).on({\n     *   preReady: e => {\n     *     // 0, 3\n     *     console.log(e.readyCount, e.totalCount),\n     *   },\n     * });\n     * ```\n     */\n    this.trigger(new ComponentEvent(\"preReady\", {\n      readyCount: this.readyCount,\n      totalCount: this.totalCount,\n      isReady: this.isReady(),\n      hasLoading: this.hasLoading()\n    }));\n  };\n  __proto.onReadyElement = function (index) {\n    var info = this.elementInfos[index];\n    /**\n     * An event occurs when the element is ready\n     * @ko 해당 엘리먼트가 준비가 되었을 때 이벤트가 발생한다.\n     * @event eg.ImReady#readyElement\n     * @param {eg.ImReady.OnReadyElement} e - The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n     * @example\n     * ```html\n     * <div>\n     *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n     *    <img src=\"./2.jpg\" data-width=\"1280\" data-height=\"853\"/>\n     *    <img src=\"ERR\" data-width=\"1280\" data-height=\"853\"/>\n     * </div>\n     * ```\n     * ## Javascript\n     * ```js\n     * import ImReady from \"@egjs/imready\";\n     *\n     * const im = new ImReady(); // umd: eg.ImReady\n     * im.check(document.querySelectorAll(\"img\")).on({\n     *   readyElement: e => {\n     *     // 1, 0, false, 3\n     *     // 2, 1, false, 3\n     *     // 3, 2, true, 3\n     *     console.log(e.readyCount, e.index, e.hasError, e.totalCount),\n     *   },\n     * });\n     * ```\n     */\n    this.trigger(new ComponentEvent(\"readyElement\", {\n      index: index,\n      element: info.element,\n      hasError: info.hasError,\n      errorCount: this.getErrorCount(),\n      totalErrorCount: this.totalErrorCount,\n      preReadyCount: this.preReadyCount,\n      readyCount: this.readyCount,\n      totalCount: this.totalCount,\n      isPreReady: this.isPreReady(),\n      isReady: this.isReady(),\n      hasLoading: info.hasLoading,\n      isPreReadyOver: this.isPreReadyOver,\n      isSkip: info.isSkip\n    }));\n  };\n  __proto.onReady = function () {\n    /**\n     * An event occurs when all element are ready\n     * @ko 모든 엘리먼트들이 준비된 경우 이벤트가 발생한다.\n     * @event eg.ImReady#ready\n     * @param {eg.ImReady.OnReady} e - The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n     * @example\n     * ```html\n     * <div>\n     *    <img src=\"./1.jpg\" data-width=\"1280\" data-height=\"853\" style=\"width:100%\"/>\n     *    <img src=\"./2.jpg\" data-width=\"1280\" data-height=\"853\"/>\n     *    <img src=\"ERR\" data-width=\"1280\" data-height=\"853\"/>\n     * </div>\n     * ```\n     * ## Javascript\n     * ```js\n     * import ImReady from \"@egjs/imready\";\n     *\n     * const im = new ImReady(); // umd: eg.ImReady\n     * im.check(document.querySelectorAll(\"img\")).on({\n     *   preReady: e => {\n     *     // 0, 3\n     *     console.log(e.readyCount, e.totalCount),\n     *   },\n     *   ready: e => {\n     *     // 1, 3\n     *     console.log(e.errorCount, e.totalCount),\n     *   },\n     * });\n     * ```\n     */\n    this.trigger(new ComponentEvent(\"ready\", {\n      errorCount: this.getErrorCount(),\n      totalErrorCount: this.totalErrorCount,\n      totalCount: this.totalCount\n    }));\n  };\n  __proto.getErrorCount = function () {\n    return this.elementInfos.filter(function (info) {\n      return info.hasError;\n    }).length;\n  };\n  __proto.hasLoading = function () {\n    return this.elementInfos.some(function (info) {\n      return info.hasLoading;\n    });\n  };\n  return ImReadyManager;\n}(Component);\nvar ImageLoader = /*#__PURE__*/function (_super) {\n  __extends(ImageLoader, _super);\n  function ImageLoader() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = ImageLoader.prototype;\n  __proto.checkElement = function () {\n    var element = this.element;\n    var src = element.getAttribute(\"src\");\n    if (element.complete) {\n      if (src) {\n        // complete\n        if (!element.naturalWidth) {\n          this.onAlreadyError(element);\n        }\n        return false;\n      } else {\n        // Using an external lazy loading module\n        this.onAlreadyPreReady();\n      }\n    }\n    this.addEvents();\n    IS_IE && element.setAttribute(\"src\", src);\n    return true;\n  };\n  ImageLoader.EVENTS = [\"load\", \"error\"];\n  return ImageLoader;\n}(Loader);\nvar VideoLoader = /*#__PURE__*/function (_super) {\n  __extends(VideoLoader, _super);\n  function VideoLoader() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = VideoLoader.prototype;\n  __proto.checkElement = function () {\n    var element = this.element;\n    // HAVE_NOTHING: 0, no information whether or not the audio/video is ready\n    // HAVE_METADATA: 1, HAVE_METADATA - metadata for the audio/video is ready\n    // HAVE_CURRENT_DATA: 2, data for the current playback position is available, but not enough data to play next frame/millisecond\n    // HAVE_FUTURE_DATA: 3, data for the current and at least the next frame is available\n    // HAVE_ENOUGH_DATA: 4, enough data available to start playing\n    if (element.readyState >= 1) {\n      return false;\n    }\n    if (element.error) {\n      this.onAlreadyError(element);\n      return false;\n    }\n    this.addEvents();\n    return true;\n  };\n  VideoLoader.EVENTS = [\"loadedmetadata\", \"error\"];\n  return VideoLoader;\n}(Loader);\nvar ImReady = /*#__PURE__*/function (_super) {\n  __extends(ImReady, _super);\n  function ImReady(options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return _super.call(this, __assign({\n      loaders: {\n        img: ImageLoader,\n        video: VideoLoader\n      }\n    }, options)) || this;\n  }\n  return ImReady;\n}(ImReadyManager);\nvar REACTIVE_IMREADY = function (_a) {\n  var setEvents = _a.setEvents,\n    setMethods = _a.setMethods,\n    on = _a.on,\n    onInit = _a.onInit,\n    onDestroy = _a.onDestroy,\n    getProps = _a.getProps;\n  setEvents(EVENTS);\n  setMethods([\"add\"]);\n  var children = [];\n  var reactiveImReady = reactive({\n    preReadyCount: 0,\n    readyCount: 0,\n    errorCount: 0,\n    totalErrorCount: 0,\n    totalCount: 0,\n    isPreReady: false,\n    isReady: false,\n    hasError: false,\n    isPreReadyOver: false,\n    add: function (element) {\n      children.push(element);\n    }\n  });\n  var props = getProps() || {};\n  var imReady = new ImReady(props);\n  imReady.on(\"error\", function (e) {\n    reactiveImReady.hasError = true;\n    reactiveImReady.errorCount = e.errorCount;\n    reactiveImReady.totalErrorCount = e.totalErrorCount;\n  }).on(\"preReadyElement\", function (e) {\n    reactiveImReady.preReadyCount = e.preReadyCount;\n  }).on(\"readyElement\", function (e) {\n    reactiveImReady.readyCount = e.readyCount;\n    reactiveImReady.isPreReadyOver = e.isPreReadyOver;\n  }).on(\"preReady\", function () {\n    reactiveImReady.isPreReady = true;\n  }).on(\"ready\", function () {\n    reactiveImReady.isReady = true;\n  });\n  on(function (_, name, callback) {\n    imReady.on(name, callback);\n    return function () {\n      imReady.off(name, callback);\n    };\n  });\n  onInit(function () {\n    var selector = props === null || props === void 0 ? void 0 : props.selector;\n    var checkedElements = [];\n    children.forEach(function (child) {\n      if (!child) {\n        return;\n      }\n      if (isString(child)) {\n        checkedElements = __spreadArrays(checkedElements, toArray(document.querySelectorAll(child)));\n      } else if (child instanceof Element) {\n        checkedElements.push(child);\n      } else if (\"value\" in child || \"current\" in child) {\n        var element = child.value || child.current;\n        if (element) {\n          checkedElements.push(element);\n        }\n      }\n    });\n    if (selector) {\n      checkedElements = checkedElements.reduce(function (prev, cur) {\n        return __spreadArrays(prev, [].slice.call(cur.querySelectorAll(selector)));\n      }, []);\n    }\n    reactiveImReady.totalCount = checkedElements.length;\n    imReady.check(checkedElements);\n  });\n  onDestroy(function () {\n    imReady.destroy();\n  });\n  return reactiveImReady;\n};\n\n/*\negjs-imready\nCopyright (c) 2020-present NAVER Corp.\nMIT license\n*/\n\nexport default ImReady;\nexport { EVENTS, ImageLoader, Loader, ImReadyManager as Manager, PROPS, REACTIVE_IMREADY, VideoLoader };\n//# sourceMappingURL=imready.esm.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}